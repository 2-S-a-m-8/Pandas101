
# 13. Reshape Data: Pivot 

## Problem Description

You are given a DataFrame `weather` with the following columns:
- `city` (object/string) – the city name  
- `month` (object/string) – the month name  
- `temperature` (int) – recorded temperature  

You need to **pivot the table** so that:
1. Each **row** corresponds to a `month`.
2. Each **column** corresponds to a `city`.
3. The `temperature` values are filled into the pivoted table.

---

## Example

### Input

```
+--------------+----------+-------------+
| city         | month    | temperature |
+--------------+----------+-------------+
| Jacksonville | January  | 13          |
| Jacksonville | February | 23          |
| Jacksonville | March    | 38          |
| Jacksonville | April    | 5           |
| Jacksonville | May      | 34          |
| ElPaso       | January  | 20          |
| ElPaso       | February | 6           |
| ElPaso       | March    | 26          |
| ElPaso       | April    | 2           |
| ElPaso       | May      | 43          |
+--------------+----------+-------------+
```

### Output (Expected Pivoted Table)

```
+----------+--------+--------------+
| month    | ElPaso | Jacksonville |
+----------+--------+--------------+
| April    | 2      | 5            |
| February | 6      | 23           |
| January  | 20     | 13           |
| March    | 26     | 38           |
| May      | 43     | 34           |
+----------+--------+--------------+
```

---

## Code Solution (Pandas)

```python
import pandas as pd

def pivotTable(weather: pd.DataFrame) -> pd.DataFrame:
    """
    Reshape the given weather DataFrame into a pivoted table where:
    - Each row represents a month.
    - Each column represents a city.
    - Cell values are the corresponding temperatures.
    """
    # Step 1: Pivot the DataFrame using pivot_table.
    pivoted_df = weather.pivot_table(
        index='month',       # Rows will be months
        columns='city',      # Columns will be cities
        values='temperature' # Fill cells with temperature values
    )

    # Step 2: Convert 'month' from index back to a column
    pivoted_df = pivoted_df.reset_index()

    # Final DataFrame now matches the expected pivoted format
    return pivoted_df
```

---

## Explanation of the Code

1. **Importing pandas**  
   We import `pandas` to work with DataFrames.

2. **Using `pivot_table()`**  
   - This function reshapes the table.  
   - `index='month'`: Each row represents a month.  
   - `columns='city'`: Each city becomes its own column.  
   - `values='temperature'`: Populates cells with the corresponding temperatures.

3. **Resetting Index**  
   - After pivoting, `month` becomes the index.  
   - `reset_index()` turns it back into a normal column to match the required output format.

4. **Return the reshaped table**  
   - The resulting table matches the expected output format exactly.

---
