# 18. Pandas Solution

## Problem Statement

We are given two tables:

### Customers Table
| Column Name | Type    |
|-------------|---------|
| id          | int     |
| name        | varchar |

- `id` is the primary key (unique) for this table.
- Each row contains the ID and name of a customer.

### Orders Table
| Column Name | Type |
|-------------|------|
| id          | int  |
| customerId  | int  |

- `id` is the primary key for this table.
- `customerId` is a foreign key referencing `Customers.id`.
- Each row represents an order placed by a customer.

We must **find all customers who never placed any orders**.

The output should be a table with:
| Customers |
|-----------|
| Name1     |
| Name2     |
... in any order.

---

## Example

**Input**  
Customers:
| id | name  |
|----|-------|
| 1  | Joe   |
| 2  | Henry |
| 3  | Sam   |
| 4  | Max   |

Orders:
| id | customerId |
|----|------------|
| 1  | 3          |
| 2  | 1          |

**Output**  
| Customers |
|-----------|
| Henry     |
| Max       |

---

## Approach

We can solve this by performing a **LEFT JOIN** between `Customers` and `Orders` on:
```
Customers.id = Orders.customerId
```
Then:
- All customers without matching `customerId` in Orders will have `NaN` in the `customerId` column after the join.
- We filter rows where `customerId` is null.
- We select only the `name` column and rename it to `Customers`.

**Steps in Pandas:**
1. Merge `customers` and `orders` DataFrames using a left join.
2. Filter rows where `customerId` is null (meaning no orders).
3. Select the `name` column.
4. Rename `name` â†’ `Customers`.
5. Return the result.

---

## Pandas Solution

```python
import pandas as pd

def find_customers(customers: pd.DataFrame, orders: pd.DataFrame) -> pd.DataFrame:
    # Step 1: Merge customers with orders (LEFT JOIN)
    df = pd.merge(customers, orders, left_on='id', right_on='customerId', how='left')
    
    # Step 2: Filter customers with no orders
    fdf = df.loc[df['customerId'].isna(), ['name']]
    
    # Step 3: Rename column to match output format
    fdf = fdf.rename(columns={'name': 'Customers'})
    
    return fdf
```

---

## Complexity Analysis

- **Time Complexity:**  
  - Merge operation: `O(N + M)` where `N` = number of customers, `M` = number of orders.
  - Filtering and renaming are `O(N)`.
- **Space Complexity:** `O(N + M)` for storing merged DataFrame.

---

## SQL Equivalent

```sql
SELECT name AS Customers
FROM Customers
LEFT JOIN Orders
ON Customers.id = Orders.customerId
WHERE Orders.customerId IS NULL;
```

---


